INSERT /*+ parallel(4)*/
INTO AP_COLL.T_ELCA_MOVED_BUFFER_BEFORE
  SELECT D.CONTRACTNR, TC.EXECUTIONDATE
    FROM OWNER_INT.VH_LCS_T_TASKCALENDAR TC
   INNER JOIN OWNER_INT.VH_LCS_T_RESULT RS
      ON RS.T_TASKCALENDAR_1 = TC.T_TASKCALENDAR_ID
    LEFT JOIN OWNER_INT.VH_LCS_T_RESULTTYPE RT
      ON RT.T_RESULTTYPE_ID = RS.T_RESULTTYPE_1
   INNER JOIN AP_COLL.T_CLASSIFIABLE_UPDATE F
      ON TC.T_CLASSIFIABLE_1 = F.T_CLASSIFIABLE_ID
   INNER JOIN AP_COLL.T_DEAL_UPDATE D
      ON D.T_DEAL_ID = F.T_DEAL_1
    JOIN OWNER_INT.VH_LCS_T_MILESTONETASK MST
      ON TC.T_MILESTONETASK_1 = MST.T_MILESTONETASK_ID
    JOIN OWNER_INT.VH_LCS_T_MILESTONE MS
      ON MS.T_MILESTONE_ID = MST.T_MILESTONE_1
   WHERE ((TC.T_TASKTYPE_1 = 23 AND MS.NAME = 'Legal Collection Medium') OR
         TC.T_TASKTYPE_1 = 43)
     AND TC.DELETED <> 1
     AND TC.ISVALID = 1
     AND RT.ALIAS = 'Done'
     AND NOT EXISTS (SELECT 1
            FROM AP_COLL.T_FINAL_BUFFER_WEEKEND B
           WHERE D.CONTRACTNR = B.CONTRACTNR)
